(()=>{"use strict";var e={254:e=>{e.exports=JSON.parse('{"ADDONS_CATEGORY_TITLE":"Addons","ADMIN_REQUIRED_MESSAGE":"Startfehler. Das Programm muss als administrator ausgeführt.","ALLOW_NEW_VERSION":"Eine neue Version des Programms ist verfügbar. Klicken Sie hier, um zur Download-Seite zu gelangen.","ALLOW_NEW_VERSION_AUTO":"Eine neue Version des Programms ist verfügbar","AUTO_INITIAL_TITLE":"Automatische Auswahl initial.pak funktioniert nur in der Version von Epic Games.","BACKUP_ERROR":"Die Sicherung konnte nicht gespeichert werden.","BACKUP_MENU_LABEL":"Sicherung","BREAK_IMPORT":"Parameter können nicht importiert werden.","BY_DEFAULT":"Standard","CARGO_CATEGORY_TITLE":"Güter","CLASSES_NOT_FOUND":"Klassen nicht gefunden","CLOSE":"Schließen","DELETE_CURRENT_INITIAL_BACKUP_ERROR":"Die aktuelle Erstsicherung konnte nicht gelöscht werden.","DELETE_OLD_INITIAL_BACKUP_ERROR":"Die alte Erstsicherung konnte nicht gelöscht werden.","DEV_MODE_LABEL":"Entwickler","DISABLE_EDITOR_LABEL_LABEL":"Signatur nicht einfügen","DLC_FOLDER_NOT_FOUND":"DLC-Ordner nicht gefunden","DLC_LABEL":"Addenda","DLC_LIST_TITLE":"Addenda","DLC_MENU_ITEM_LABEL":"DLC","EDIT_FILE_BUTTON":"Bearbeiten","EMPTY":"Leer","EMPTY_FOLDER_ERROR":"Sie haben keinen Ordner ausgewählt!","ENGINES_CATEGORY_TITLE":"Motoren","ERROR":"Fehler","EXIT_MENU_ITEM_LABEL":"Exit","EXPORT":"Export","FILE_IS_RESETED":"Die Einstellungen wurden zurückgesetzt.","FILE_MENU_LABEL":"Datei","FIRST_STEPS_DESCRIPTION":"Ersteinrichtung des Programms.","GAME_FOLDER_LABEL":"Spiel-Ordner","GEARBOXES_CATEGORY_TITLE":"Getriebe","HELP_MENU_LABEL":"Hilfe","HOW_TO_USE_TITLE":"Wie benutzt man","IGNORE":"Ignorieren","IMPORT":"Import","INITIAL_LABEL":"Pfad zu initial.pak","INITIAL_NOT_FOUND":"initial.pak nicht gefunden","INVALID_FOLDER_ERROR":"Sie haben den falschen Ordner ausgewählt!","INVALID_INITIAL_ERROR":"Ungültiger initial ausgewählt.pak","INVALID_MODS_ALERT_MAIN":"Die Änderung konnte nicht geladen werden","INVALID_MODS_ALERT_NOT_EXISTS":"Die Änderungsdatei fehlt. Möglicherweise wurde es gelöscht oder verschoben.","INVALID_MODS_ALERT_NO_CLASSES":"Der Ordner classes fehlt. Vielleicht haben Sie den falschen gewählt .pak Änderung.","INVALID_MODS_ALERT_NO_PERMISSION":"Kein Zugriff auf das Lesen oder Schreiben der Datei. Überprüfen Sie die schreibgeschützte Eigenschaft der Datei.","LANGUAGE_MENU_ITEM_LABEL":"Sprache","LIMITS_LABEL":"Beschränkungen","LIST_TITLE":"Wählen Sie zum Bearbeiten","LOADING":"Herunterladen","MAIN_LIST_TITLE":"Original","MANUAL_INITIAL":"Manuelle Auswahl von initial.pak","MODS_ADD_BUTTON":"Hinzufügen","MODS_FOLDER_NOT_EXISTED":"Ordner mit Mods nicht gefunden","MODS_LABEL":"Modifikationen","MODS_LIST_TITLE":"Modifikationen","NOTIFICATION":"Norifizierung","NO_GAME_FOLDER":"Die Auswahl des Ordners mit dem Spiel ist obligatorisch!","ONLY_DEVELOPER_EDIT_TEXT":"Nur im Entwicklermodus bearbeiten","OPEN_BUTTON":"Öffnen","OPEN_INITIAL_BUTTON":"Öffnen Sie einen Ordner mit initial.pak","OPEN_WINDOW_ERROR":"Das Fenster konnte nicht geöffnet werden.","PARAMS_FILE_NOT_FOUND":"Die zu importierende Datei ist nicht ausgewählt.","PARSE_FILE_ERROR":"Datei kann nicht erkannt werden","PATHS_MENU_ITEM_LABEL":"Pfade","PATH_TO_SAVE_NOT_FOUND":"Es wurde kein Exportpfad angegeben.","READ_FILE_ERROR":"Die Datei konnte nicht im Pfad gelesen werden.","RECOGNIZE_ERROR":"Fehler bei der Dateierkennung","RELAUNCH_PROMPT":"Um den Mod zu laden, müssen Sie das Programm neu starten. Einen Neustart durchführen?","RESET_BUTTON_LABEL":"Reset-Taste","RESET_CONFIRM_MESSAGE":"Möchten Sie wirklich alle Einstellungen auf die ursprünglichen zurücksetzen?","RESET_MENU_ITEM_LABEL":"Zurücksetzen","RESTORE_MENU_ITEM_LABEL":"Standard Wiederherstellen","SAVE_BUTTON":"Datei","SAVE_CONFIG_ERROR":"Die Konfiguration konnte nicht gespeichert werden.","SAVE_INITIAL_BACKUP_ERROR":"Erste Sicherung konnte nicht gespeichert werden.","SAVE_MOD_ERROR":"Die Änderungsdateien konnten nicht gespeichert werden. Sie haben keinen Zugriff auf das Schreiben der Datei.","SAVE_ORIGINAL_ERROR":"Die Dateien in initial konnten nicht aktualisiert werden.pak. Kein Zugriff auf den Datensatz","SAVING_MESSAGE":"Speichern...","SEARCH":"Suche","SELECT_GROUP":"Gruppe Wählen","SETTINGS_MENU_ITEM_LABEL":"Einstellungen","SUCCESS":"Erfolg","SUCCESS_BACKUP_SAVE":"Die Initiale.pak backup wurde erfolgreich gespeichert.","SUCCESS_INITIAL_RESTORE":"initial.pak wurde erfolgreich restauriert.","SUSPENSIONS_CATEGORY_TITLE":"Suspensionen","TRAILERS_CATEGORY_TITLE":"Nutzfahrzeuge","TRUCKS_CATEGORY_TITLE":"Autos","UNDEFINED_LIST_TYPE":"Ungültiger Blatttyp. Der Typ ist nicht einer von [trucks, trailers, cargo].","UNPACKING":"Auspacken","UPDATE":"Aktualisieren","UPDATES_LABEL":"Updates","WAS_EXPORTED":"Die Einstellungen wurden exportiert.","WAS_IMPORTED":"Einstellungen importiert.","WHEELS_CATEGORY_TITLE":"Räder","WINCHES_CATEGORY_TITLE":"Winden","WRITE_FILE_ERROR":"Fehler beim Schreiben in die Datei."}')},285:e=>{e.exports=JSON.parse('{"ADDONS_CATEGORY_TITLE":"Addons","ADMIN_REQUIRED_MESSAGE":"Startup error. The program must be run as an administrator.","ALLOW_NEW_VERSION":"A new version of the program is available. Click to go to the download page.","ALLOW_NEW_VERSION_AUTO":"A new version of the program is available","AUTO_INITIAL_TITLE":"The automatic selection of initial.pak only works in the version from Epic Games.","BACKUP_ERROR":"Failed to save backup.","BACKUP_MENU_LABEL":"Backup","BREAK_IMPORT":"Parameters cannot be imported.","BY_DEFAULT":"Default","CARGO_CATEGORY_TITLE":"Cargo","CLASSES_NOT_FOUND":"Папка classes not found","CLOSE":"Close","DELETE_CURRENT_INITIAL_BACKUP_ERROR":"Failed to delete the current initial backup.","DELETE_OLD_INITIAL_BACKUP_ERROR":"Failed to delete the old initial backup.","DEV_MODE_LABEL":"Developer","DISABLE_EDITOR_LABEL_LABEL":"Do not insert signature","DLC_FOLDER_NOT_FOUND":"DLC folder not found","DLC_LABEL":"DLC","DLC_LIST_TITLE":"DLC","DLC_MENU_ITEM_LABEL":"DLC","EDIT_FILE_BUTTON":"Edit","EMPTY":"Empty","EMPTY_FOLDER_ERROR":"You didn\\"t select a folder!","ENGINES_CATEGORY_TITLE":"Engines","ERROR":"Error","EXIT_MENU_ITEM_LABEL":"Exit","EXPORT":"Export","FILE_IS_RESETED":"The parameters were reset.","FILE_MENU_LABEL":"File","FIRST_STEPS_DESCRIPTION":"Initial setup of the program.","GAME_FOLDER_LABEL":"Game folder","GEARBOXES_CATEGORY_TITLE":"Gearboxes","HELP_MENU_LABEL":"Help","HOW_TO_USE_TITLE":"How to use","IGNORE":"Ignore","IMPORT":"Import","INITIAL_LABEL":"Path to initial.pak","INITIAL_NOT_FOUND":"initial.pak not found","INVALID_FOLDER_ERROR":"You have selected the wrong folder!","INVALID_INITIAL_ERROR":"Invalid initial.pak selected","INVALID_MODS_ALERT_MAIN":"Failed to load the modification","INVALID_MODS_ALERT_NOT_EXISTS":"The modification file is missing. It may have been deleted or moved.","INVALID_MODS_ALERT_NO_CLASSES":"The classes folder is missing. You may have chosen the wrong one .pak modifications.","INVALID_MODS_ALERT_NO_PERMISSION":"There is no access to read or write the file. Check the \'read-only\' property of the file.","LANGUAGE_MENU_ITEM_LABEL":"Language","LIMITS_LABEL":"Restrictions","LIST_TITLE":"Select to edit","LOADING":"Loading","MAIN_LIST_TITLE":"Main","MANUAL_INITIAL":"Manual selection of initial.pak","MODS_ADD_BUTTON":"Add","MODS_FOLDER_NOT_EXISTED":"Mod folder not found","MODS_LABEL":"Mods","MODS_LIST_TITLE":"Mods","NOTIFICATION":"Notification","NO_GAME_FOLDER":"The choice of the folder with the game is required!","ONLY_DEVELOPER_EDIT_TEXT":"Edit only in developer mode","OPEN_BUTTON":"Open","OPEN_INITIAL_BUTTON":"Open a folder with initial.pak","OPEN_WINDOW_ERROR":"The window could not be opened.","PARAMS_FILE_NOT_FOUND":"The file for import is not selected.","PARSE_FILE_ERROR":"The file cannot be recognized","PATHS_MENU_ITEM_LABEL":"Paths","PATH_TO_SAVE_NOT_FOUND":"The export path is not specified.","READ_FILE_ERROR":"Could not read the file on the path.","RECOGNIZE_ERROR":"File recognition error","RELAUNCH_PROMPT":"To add the mod, you need to restart the program. Perform a reboot?","RESET_BUTTON_LABEL":"Reset button","RESET_CONFIRM_MESSAGE":"Do you really want to reset all the parameters to the original ones?","RESET_MENU_ITEM_LABEL":"Reset","RESTORE_MENU_ITEM_LABEL":"Restore","SAVE_BUTTON":"Save","SAVE_CONFIG_ERROR":"Failed to save the config.","SAVE_INITIAL_BACKUP_ERROR":"Failed to save initial backup.","SAVE_MOD_ERROR":"The modification files could not be saved. There is no write access to the file.","SAVE_ORIGINAL_ERROR":"Failed to update files in initial. pak. There is no access to the record","SAVING_MESSAGE":"Saving...","SEARCH":"Search","SELECT_GROUP":"Choose group","SETTINGS_MENU_ITEM_LABEL":"Settings","SUCCESS":"Success","SUCCESS_BACKUP_SAVE":"The initial.pak backup was saved successfully.","SUCCESS_INITIAL_RESTORE":"initial.pak was successfully restored.","SUSPENSIONS_CATEGORY_TITLE":"Suspensions","TRAILERS_CATEGORY_TITLE":"Trailers","TRUCKS_CATEGORY_TITLE":"Trucks","UNDEFINED_LIST_TYPE":"Incorrect sheet type. The type is not one of [trucks, trailers, cargo].","UNPACKING":"Unpacking","UPDATE":"Update","UPDATES_LABEL":"Updates","WAS_EXPORTED":"The parameters are exported.","WAS_IMPORTED":"The parameters are imported.","WHEELS_CATEGORY_TITLE":"Wheels","WINCHES_CATEGORY_TITLE":"Winches","WRITE_FILE_ERROR":"Could not write to file."}')},2:e=>{e.exports=JSON.parse('{"ADDONS_CATEGORY_TITLE":"Аддоны","ADMIN_REQUIRED_MESSAGE":"Ошибка запуска. Программа должна быть запущена от имени администратора.","ALLOW_NEW_VERSION":"Доступна новая версия программы. Нажмите чтобы перейти на страницу скачивания.","ALLOW_NEW_VERSION_AUTO":"Доступна новая версия программы","AUTO_INITIAL_TITLE":"Автоматичекий выбор initial.pak работает только в версии от Epic Games.","BACKUP_ERROR":"Не удалось сохранить бэкап.","BACKUP_MENU_LABEL":"Бэкап","BREAK_IMPORT":"Невозможно импортировать параметры.","BY_DEFAULT":"По умолчанию","CARGO_CATEGORY_TITLE":"Грузы","CLASSES_NOT_FOUND":"Папка classes не найдена.","CLOSE":"Закрыть","DELETE_CURRENT_INITIAL_BACKUP_ERROR":"Не удалось удалить текущий бэкап initial.pak","DELETE_OLD_INITIAL_BACKUP_ERROR":"Не удалось удалить старый бэкап initial.pak.","DEV_MODE_LABEL":"Разработчик","DISABLE_EDITOR_LABEL_LABEL":"Не вставлять подпись","DLC_FOLDER_NOT_FOUND":"Папка с дополнениями не найдена","DLC_LABEL":"DLC","DLC_LIST_TITLE":"Дополнения","DLC_MENU_ITEM_LABEL":"Дополнения","EDIT_FILE_BUTTON":"Редактировать","EMPTY":"Пусто","EMPTY_FOLDER_ERROR":"Вы не выбрали папку!","ENGINES_CATEGORY_TITLE":"Двигатели","ERROR":"Ошибка","EXIT_MENU_ITEM_LABEL":"Выход","EXPORT":"Экспорт","FILE_IS_RESETED":"Параметры были сброшены.","FILE_MENU_LABEL":"Файл","FIRST_STEPS_DESCRIPTION":"Первоначальная настройка.","GAME_FOLDER_LABEL":"Папка с игрой","GEARBOXES_CATEGORY_TITLE":"Коробки передач","HELP_MENU_LABEL":"Помощь","HOW_TO_USE_TITLE":"Как пользоваться","IGNORE":"Игнорировать","IMPORT":"Импорт","INITIAL_LABEL":"Путь к initial.pak","INITIAL_NOT_FOUND":"initial.pak не найден.","INVALID_FOLDER_ERROR":"Вы выбрали неправильную папку. Попробуйте вручную выбрать initial.pak","INVALID_INITIAL_ERROR":"Выбран неверный initial.pak","INVALID_MODS_ALERT_MAIN":"Не удалось загрузить модификацию","INVALID_MODS_ALERT_NOT_EXISTS":"Файл модификации отсутствует. Возможно он был удалён или перенесён.","INVALID_MODS_ALERT_NO_CLASSES":"Отсутствует папка classes. Возможно вы выбрали не тот .pak модификации.","INVALID_MODS_ALERT_NO_PERMISSION":"Нет доступа к чтению или записи файла. Проверьте свойство \'только для чтения\' у файла.","LANGUAGE_MENU_ITEM_LABEL":"Язык","LIMITS_LABEL":"Ограничения","LIST_TITLE":"Выберите для редактирования","LOADING":"Загрузка","MAIN_LIST_TITLE":"Основное","MANUAL_INITIAL":"Ручной выбор initial.pak","MODS_ADD_BUTTON":"Добавить","MODS_FOLDER_NOT_EXISTED":"Не найдена папка с модами","MODS_LABEL":"Модификации","MODS_LIST_TITLE":"Модификации","NOTIFICATION":"Уведомление","NO_GAME_FOLDER":"Выбор папки с игрой обязателен!","ONLY_DEVELOPER_EDIT_TEXT":"Только в режиме разработчика","OPEN_BUTTON":"Открыть","OPEN_INITIAL_BUTTON":"Открыть папку с initial.pak","OPEN_WINDOW_ERROR":"Не удалось открыть окно.","PARAMS_FILE_NOT_FOUND":"Файл для импорта не выбран.","PARSE_FILE_ERROR":"Файл не может быть распознан","PATHS_MENU_ITEM_LABEL":"Пути","PATH_TO_SAVE_NOT_FOUND":"Не указан путь для экспорта.","READ_FILE_ERROR":"Не удалось считать файл по пути.","RECOGNIZE_ERROR":"Ошибка распознания файла","RELAUNCH_PROMPT":"Для загрузки мода необходима перезагрузка программы. Выполнить перезагрузку?","RESET_BUTTON_LABEL":"Кнопка сброса","RESET_CONFIRM_MESSAGE":"Вы действительно хотите сбросить все параметры до исходных?","RESET_MENU_ITEM_LABEL":"Сбросить","RESTORE_MENU_ITEM_LABEL":"Восстановить","SAVE_BUTTON":"Сохранить","SAVE_CONFIG_ERROR":"Не удалось сохранить конфиг.","SAVE_INITIAL_BACKUP_ERROR":"Не удалось сделать бэкап initial.pak.","SAVE_MOD_ERROR":"Не удалось сохранить файлы модификации. Нет доступа к записи файла.","SAVE_ORIGINAL_ERROR":"Не удалось обновить файлы в initial.pak. Нет доступа к записи","SAVING_MESSAGE":"Сохранение...","SEARCH":"Поиск","SELECT_GROUP":"Выберите группу","SETTINGS_MENU_ITEM_LABEL":"Настройки","SUCCESS":"Успех","SUCCESS_BACKUP_SAVE":"Бэкап initial.pak успешно сохранён.","SUCCESS_INITIAL_RESTORE":"initial.pak был успешно восстановлен.","SUSPENSIONS_CATEGORY_TITLE":"Подвески","TRAILERS_CATEGORY_TITLE":"Прицепы","TRUCKS_CATEGORY_TITLE":"Автомобили","UNDEFINED_LIST_TYPE":"Неправильный тип листа. Тип не является одним из [trucks, trailers, cargo].","UNPACKING":"Распаковка","UPDATE":"Обновить","UPDATES_LABEL":"Обновления","WAS_EXPORTED":"Параметры экспортированы.","WAS_IMPORTED":"Параметры импортированы.","WHEELS_CATEGORY_TITLE":"Колёса","WINCHES_CATEGORY_TITLE":"Лебёдки","WRITE_FILE_ERROR":"Не удалось записать в файл."}')}},n={};function i(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,i),r.exports}i.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return i.d(n,{a:n}),n},i.d=(e,n)=>{for(var t in n)i.o(n,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},i.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.ab=__dirname+"/native_modules/";var t={};(()=>{i.r(t);const e=require("https");var n=i.n(e);const o=require("dns");var r=i.n(o);const s=require("electron"),a=require("path"),E=require("fs"),l=require("child_process"),_=require("crypto"),c={publicInfo:"https://verzsut.github.io/sxmle_updater/public.json",downloadPage:"https://verzsut.github.io/SnowRunner-XML-Editor-Desktop/download.html",updateFiles:"https://verzsut.github.io/sxmle_updater/files",updateMap:"https://verzsut.github.io/sxmle_updater/updateMap.json",root:__dirname,config:`${__dirname}SXMLE\\config.json`.replace("SXMLE",""),backupFolder:`${__dirname}\\backups`,icon:`${__dirname}\\favicon.ico`,backupInitial:`${__dirname}\\backups\\initial.pak`,translations:(0,a.normalize)(`${__dirname}SXMLE\\translations`.replace("SXMLE","")),winrar:`${__dirname}\\winrar`,mainTemp:`${__dirname}\\mainTemp`,modsTemp:`${__dirname}\\modsTemp`,strings:`${__dirname}\\mainTemp\\[strings]`,dlc:`${__dirname}\\mainTemp\\[media]\\_dlc`,classes:`${__dirname}\\mainTemp\\[media]\\classes`};function d(e){const n={},i=e.match(/[^\r\n]+/g);if(i)for(const e of i){const i=e.match(/(.*?)[\s\t]*(\".*?\")/);if(i&&3===i.length){const e=i[1].replaceAll('"',"").replaceAll("'","").replaceAll("\ufeff","");try{const t=JSON.parse(i[2].replaceAll("\\",""));n[e]=t}catch{console.log(i)}}}return n}function T(e,n=!1,i=".xml",t=!1){if(!(0,E.existsSync)(e))return[];let o=[];const r=(0,E.readdirSync)(e);for(let s=0;s<r.length;s++){const l=(0,a.join)(e,r[s]),_=(0,E.lstatSync)(l);if(n){if(!_.isDirectory())continue;o.push({name:r[s],path:l})}_.isDirectory()&&t?o=[...o,...T(l,!1,i,!0)]:r[s].indexOf(i)>=0&&o.push({name:r[s].replace(i,""),path:l})}return o}function u(e){return(0,E.existsSync)(e)?(0,_.createHash)("sha1").update((0,E.readFileSync)(e)).digest("hex"):""}function p(e){const n=(0,a.dirname)(e),i=(0,a.dirname)(n);(0,E.existsSync)(i)||p(n),(0,E.existsSync)(n)||(0,E.mkdirSync)(n)}const S=new class{update(e,n){(0,l.execSync)(`WinRAR f -ibck -inul "${n}" "${e}\\" -r -ep1`,{cwd:c.winrar})}unpack(e,n,i=!1){return new Promise((t=>{(0,l.exec)(`WinRAR x -ibck -inul "${e}" @${i?"unpack-mod-list.lst":"unpack-list.lst"} "${n}\\"`,{cwd:c.winrar}).once("close",(()=>{t(void 0)}))}))}},L={properties:[],functions:[]};s.ipcMain.on("getInfo",(e=>{e.returnValue=L}));const I=new class{setFunctions(e){for(const n in e)"function"==typeof e[n]&&(L.functions.push(n),s.ipcMain.on(`function_${n}_call`,((i,...t)=>{try{const o=e[n](...t);i.returnValue={value:o}}catch(e){i.returnValue={error:e}}})))}setProperties(e){for(const n in e){const i=e[n];if(L.properties.push(n),i instanceof Array&&i.length>0){const e=i[0],t=i[1];"function"==typeof e&&s.ipcMain.on(`property_${n}_get`,((n,...i)=>{try{const t=e(...i);n.returnValue={value:t}}catch(e){n.returnValue={error:e}}})),"function"==typeof t&&s.ipcMain.on(`property_${n}_set`,((e,...n)=>{try{const i=t(...n);e.returnValue={value:i}}catch(n){e.returnValue={error:n}}}))}else"function"==typeof i&&s.ipcMain.on(`property_${n}_get`,((e,...n)=>{try{const t=i(...n);e.returnValue={value:t}}catch(n){e.returnValue={error:n}}}))}}},R={appId:"SnowRunner XML editor",saveWhenReload:!0,devTools:!1},O={mainWindow:null,listWindow:null,xmlEditor:null,currentWindow:null,loading:null};let A;const h=function(){const e=(0,E.readFileSync)(c.config);return JSON.parse(e.toString())}(),m={RU:i(2),EN:i(285),DE:i(254),mods:{},ingame:{}};function N(){h.sums.initial=u(h.paths.initial)}function g(e,i){if(e.array){e.isRoot&&e.downloadPage.setCount(e.array.length);const{url:n,path:t}=e.array[0];return e.downloadPage.setText((0,a.basename)(t)),void g({url:n,path:t,downloadPage:e.downloadPage},(()=>{i(),e.array.length>1&&g({array:e.array.slice(1),downloadPage:e.downloadPage},i)}))}n().get(e.url,(n=>{if(e.inMemory){let t="";n.on("data",(e=>{t+=e})),n.on("end",(()=>{e.fromJSON?i(JSON.parse(t)):i(t)}))}else{const t=(0,E.createWriteStream)(e.path);if(e.downloadPage){const i=parseInt(n.headers["content-length"],10);let t=0;n.on("data",(n=>{t+=n.length,e.downloadPage.setPersent((t/i*100).toFixed(2))}))}n.pipe(t),n.on("end",(()=>{e.downloadPage.success(),t.on("close",i),t.close()}))}}))}function f(e,n){const i=[],t=(0,E.readdirSync)(e);for(const o of t){const t=(0,a.join)(e,o);if((0,E.lstatSync)(t).isDirectory()){const e=f(t,n);e&&i.push(...e)}else n[t.replace((0,a.join)(c.root,"/"),"")]||i.push(t)}return i}function D(){if((0,E.existsSync)(`${c.backupFolder}\\config.json`)){const e=JSON.parse((0,E.readFileSync)(`${c.backupFolder}\\config.json`));e.version=h.version,R.saveWhenReload=!1,e.version<"v0.6.5"&&(e.ADV={},e.ETR={}),(0,E.writeFileSync)(c.config,JSON.stringify(e)),(0,E.rmSync)(`${c.backupFolder}\\config.json`),Y()}}function w(){(0,E.existsSync)(c.backupFolder)&&(0,E.writeFileSync)(`${c.backupFolder}\\config.json`,JSON.stringify(h))}function M(e=!1){(h.settings.updates||e)&&r().resolve("github.com",(e=>{e||n().get(c.publicInfo,(e=>{e.setEncoding("utf-8");let n="";e.on("data",(e=>{n+=e})),e.on("end",(()=>{const e=JSON.parse(n);h.version<e.latestVersion&&(e.canAutoUpdate?function(e){const n=O.currentWindow,i=x({path:`file://${require("path").resolve(__dirname,"..","renderer","update","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","main","preload.js"),width:400,height:200,frame:!1,modal:!0,parent:O.currentWindow,resizable:!1});i.once("show",(()=>{i.webContents.postMessage("content",e)})),i.once("close",(()=>{O.currentWindow=n,n.focus()}))}(e.latestVersion):U("[NOTIFICATION]","ALLOW_NEW_VERSION").then((()=>{s.shell.openExternal(c.downloadPage)})))}))}))}))}function y(e){try{return(0,E.writeFileSync)(e,(0,E.readFileSync)(e)),!0}catch{return!1}}function U(e,n){return new Promise((i=>{if(s.Notification.isSupported()){const t=new s.Notification({title:V(e),icon:c.icon,body:V(n)});t.show(),t.once("click",i)}}))}function C(){return new Promise((e=>{if(O.mainWindow)return O.mainWindow.show(),O.mainWindow.focus(),void e();O.mainWindow=x({path:`file://${require("path").resolve(__dirname,"..","renderer","main","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","main","preload.js"),width:980,height:380,resizable:!1}),O.mainWindow.once("show",(()=>{e(),O.loading.isDestroyed()||O.loading.close()})),O.mainWindow.once("close",(()=>{s.app.quit()}))}))}function P(e=!1){const n=O.currentWindow,i=x({path:`file://${require("path").resolve(__dirname,"..","renderer","download","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","download","preload.js"),width:230,height:100,modal:!e,parent:e?null:O.currentWindow,frame:!1});return e||i.once("close",(()=>{O.currentWindow=n,n.focus()})),i.setText=e=>i.webContents.postMessage("fileName",e),i.setCount=e=>i.webContents.postMessage("count",e),i.setPersent=e=>i.webContents.postMessage("percent",e),i.success=()=>i.webContents.postMessage("success",!0),i.download=()=>i.webContents.postMessage("download",!0),i}function B(e=!1){return new Promise((n=>{const i=P(e);i.once("show",(()=>{i.setText(V("[UNPACKING]"))})),(0,E.existsSync)(c.mainTemp)&&(0,E.rmSync)(c.mainTemp,{recursive:!0}),(0,E.mkdirSync)(c.mainTemp),S.unpack(h.paths.initial,c.mainTemp).then((()=>{n(),i.isDestroyed()||i.close()}))}))}function k(e){return new Promise((n=>{const i=(0,a.join)(c.modsTemp,(0,a.basename)(e,".pak"));y(e)||n(),(0,E.existsSync)(c.modsTemp)||(0,E.mkdirSync)(c.modsTemp),(0,E.existsSync)(i)&&(0,E.rmSync)(i,{recursive:!0}),(0,E.mkdirSync)(i),S.unpack(e,i,!0).then((()=>n()))}))}function F(e=!1){return new Promise((n=>{B().then((()=>{if((0,E.existsSync)(c.backupFolder)||(0,E.mkdirSync)(c.backupFolder),(0,E.existsSync)(c.backupInitial))try{(0,E.unlinkSync)(c.backupInitial)}catch{throw new Error("[DELETE_OLD_INITIAL_BACKUP_ERROR]")}b(),e&&Y(),n()}))}))}function b(){try{(0,E.copyFileSync)(h.paths.initial,c.backupInitial),U("[SUCCESS]","[SUCCESS_BACKUP_SAVE]")}catch{throw new Error("[SAVE_INITIAL_BACKUP_ERROR]")}}function v(){try{(0,E.writeFileSync)(c.config,JSON.stringify(h,null,"\t"))}catch{throw new Error("[SAVE_CONFIG_ERROR]")}}function x(e={}){const n=new s.BrowserWindow({width:e.width||800,height:e.height||600,resizable:void 0===e.resizable||e.resizable,icon:c.icon,show:e.show||!1,parent:e.parent||null,modal:e.modal||!1,frame:!(!1===e.frame),paintWhenInitiallyHidden:!1,webPreferences:{preload:e.preload,contextIsolation:!1}});return O.currentWindow=n,n.setMenu(null),n.loadURL(e.path).then((()=>{n.show(),n.isDestroyed()||(n.focus(),R.devTools&&n.webContents.toggleDevTools())})),n}function W(e=!1){h.paths={initial:null,dlc:null,classes:null,mods:null},h.dlcList=[],h.modsList={length:0},h.ADV={},h.ETR={},h.settings={updates:!0,limits:!0,DLC:!0,mods:!0,resetButton:!1,devMode:!1},h.sums={initial:null,mods:{}},h.lang="EN",G(),e?v():Y()}function G(){if((0,E.existsSync)(c.backupInitial))try{(0,E.unlinkSync)(c.backupInitial)}catch(e){U("[ERROR]","[DELETE_OLD_INITIAL_BACKUP_ERROR]")}(0,E.existsSync)(c.mainTemp)&&((0,E.rmSync)(c.mainTemp,{recursive:!0}),(0,E.mkdirSync)(c.mainTemp)),(0,E.existsSync)(c.modsTemp)&&((0,E.rmSync)(c.modsTemp,{recursive:!0}),(0,E.mkdirSync)(c.modsTemp))}function V(e,n=!0){const i=m[h.lang];if(i)return i[function(e){if(e||""===e)return e.replaceAll("[","").replaceAll("]","")}(e)]||(n?e:void 0)}function Y(){s.app.relaunch(),s.app.quit()}s.app.disableHardwareAcceleration(),s.app.setAppUserModelId(R.appId),s.app.whenReady().then((function(){I.setProperties({invalidMod:()=>A,translations:()=>m,shortMenu:()=>getShortMenu(),menu:()=>function(){function e(e,n){return e?n:[]}return[{label:V("[FILE_MENU_LABEL]"),submenu:[...e(h.paths.initial,[{label:V("[SETTINGS_MENU_ITEM_LABEL]"),role:"openSettings"},{role:"separator"}]),...e(("dev"===h.buildType||h.settings.resetButton)&&h.paths.initial,[{label:V("[RESET_MENU_ITEM_LABEL]"),role:"resetConfig"}]),...e("dev"===h.buildType,[{label:"DevTools",role:"devTools"},{label:"Reload",role:"reload"}]),{label:V("[EXIT_MENU_ITEM_LABEL]"),role:"quitApp"}]},...e(h.paths.initial,[{label:V("[BACKUP_MENU_LABEL]"),submenu:[{label:V("[OPEN_BUTTON]"),role:"showFolder",path:c.backupFolder},{role:"separator"},{label:V("[SAVE_BUTTON]"),role:"saveBackup"},{label:V("[RESTORE_MENU_ITEM_LABEL]"),role:"restoreInitial"}]}]),{label:V("[HELP_MENU_LABEL]"),submenu:[{label:V("[HOW_TO_USE_TITLE]"),role:"open-link",url:"https://snowrunner.mod.io/guides/snowrunner-xml-editor"},{label:"GitHub",role:"open-link",url:"https://github.com/VerZsuT/SnowRunner-XML-Editor-Desktop"},{label:"YouTube(RU)",role:"open-link",url:"https://youtube.com/playlist?list=PLDwd4yUwzS2VtWCpC9X6MXm47Kv_s_mq2"}]}]}(),paths:()=>c,config:[()=>h,e=>{h[e.key]=e.value}]}),I.setFunctions({saveToOriginal:e=>{if(e)try{S.update((0,a.join)(c.modsTemp,e),h.modsList[e].path),function(e,n){h.sums.mods[e]=u(n)}(e,h.modsList[e].path)}catch(e){s.dialog.showMessageBoxSync({title:V("[ERROR]"),message:V("[SAVE_MOD_ERROR]")})}else try{S.update(c.mainTemp,h.paths.initial),N()}catch(e){s.dialog.showMessageBoxSync({title:V("[ERROR]"),message:V("[SAVE_ORIGINAL_ERROR]")})}},openDevTools:()=>{O.currentWindow.webContents.toggleDevTools()},getFileData:(e,n=null)=>{if((0,E.existsSync)(e))return(0,E.readFileSync)(e).toString();if((0,E.existsSync)(n))return(0,E.readFileSync)(n).toString();throw new Error("[READ_FILE_ERROR]")},setDevMode:e=>{h.settings.devMode=e,Y()},setFileData:(e,n)=>{try{(0,E.writeFileSync)(e,n)}catch{throw new Error("[WRITE_FILE_ERROR]")}},alert:e=>{s.dialog.showMessageBox({icon:c.icon,message:e,title:R.appId})},alertSync:e=>{s.dialog.showMessageBoxSync({icon:c.icon,message:e,title:R.appId})},confirm:e=>0===s.dialog.showMessageBoxSync({icon:c.icon,message:e,title:R.appId,buttons:["OK",V("[CLOSE]")]}),reload:()=>{Y()},quit:()=>{s.app.quit()},openLink:e=>{s.shell.openExternal(e)},showFolder:e=>{s.shell.openPath(e)},importConfig:()=>{D()},exportConfig:()=>{w()},openXMLEditor:()=>{!function(){O.xmlEditor&&O.xmlEditor.hide(),O.listWindow?O.listWindow.hide():O.mainWindow&&O.mainWindow.hide();const e=x({path:`file://${require("path").resolve(__dirname,"..","renderer","editor","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","editor","preload.js"),width:1e3,height:800});O.xmlEditor?e.once("close",(()=>{O.xmlEditor&&!O.xmlEditor.isDestroyed()&&(O.currentWindow=O.xmlEditor,O.xmlEditor.show(),O.xmlEditor.focus())})):(O.xmlEditor=e,e.once("close",(()=>{O.xmlEditor=null,O.listWindow&&!O.listWindow.isDestroyed()&&(O.currentWindow=O.listWindow,O.listWindow.show(),O.listWindow.focus())})))}()},openList:()=>{!function(){if(O.listWindow)return O.listWindow.show(),void O.listWindow.focus();O.mainWindow&&O.mainWindow.hide(),O.listWindow=x({path:`file://${require("path").resolve(__dirname,"..","renderer","list","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","list","preload.js"),width:1100,height:640}),O.listWindow.once("close",(()=>{delete O.listWindow,O.mainWindow&&!O.mainWindow.isDestroyed()&&(O.currentWindow=O.mainWindow,O.mainWindow.show(),O.mainWindow.focus())}))}()},openSettings:()=>{!function(){const e=O.currentWindow;x({path:`file://${require("path").resolve(__dirname,"..","renderer","settings","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","settings","preload.js"),width:400,height:550,modal:!0,parent:O.currentWindow}).once("close",(()=>{O.currentWindow=e,e.focus()}))}()},openDialog:()=>function(){const e=s.dialog.showOpenDialogSync({properties:["openDirectory"]});if(e instanceof Array)return e[0]}(),openXMLDialog:()=>function(){const e=s.dialog.showOpenDialogSync({properties:["openFile"],filters:[{name:"XML file",extensions:["xml"]}]});if(e instanceof Array)return e[0]}(),openInitialDialog:()=>function(){const e=s.dialog.showOpenDialogSync({properties:["openFile"],filters:[{name:"Pak file",extensions:["pak"]}]});if(e instanceof Array)return e[0]}(),openJSONDialog:()=>function(){const e=s.dialog.showOpenDialogSync({properties:["openFile"],filters:[{name:"Editor params file",extensions:["epf"]}]});if(e instanceof Array)return e[0]}(),openSaveDialog:e=>{return n=e,s.dialog.showSaveDialogSync({defaultPath:n,filters:[{name:"Editor params file",extensions:["epf"]}]});var n},openConsole:()=>{!function(){const e=O.currentWindow;x({path:`file://${require("path").resolve(__dirname,"..","renderer","console","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","console","preload.js"),width:500,height:500}).once("close",(()=>{O.currentWindow=e,e.focus()}))}()},saveBackup:e=>{F(e)},copyBackup:()=>{b()},resetConfig:e=>{W(e)},restoreInitial:()=>{!function(){if((0,E.existsSync)(c.backupInitial)){if((0,E.existsSync)(h.paths.initial))try{(0,E.unlinkSync)(h.paths.initial)}catch{s.dialog.showMessageBoxSync({type:"warning",title:V("[ERROR]"),message:V("[DELETE_CURRENT_INITIAL_BACKUP_ERROR]")})}try{(0,E.copyFileSync)(c.backupInitial,h.paths.initial),B().then((()=>{N(),U("[SUCCESS]","[SUCCESS_INITIAL_RESTORE]")}))}catch{s.dialog.showMessageBoxSync({type:"warning",title:V("[ERROR]"),message:V("[DELETE_CURRENT_INITIAL_BACKUP_ERROR]")})}}}()},saveConfig:()=>{v()},saveInitialSum:()=>{N()},checkUpdate:e=>{M(e)},update:()=>{!function(){const e=P();e.once("show",(()=>{e.download()})),G(),g({url:c.updateMap,fromJSON:!0,inMemory:!0},(n=>{let[i,t]=function(e){const n=f(c.root,e)||[],i=[];for(const t in e){const o=(0,a.join)(c.root,t);if((0,E.existsSync)(o)){if((0,E.lstatSync)(o).isDirectory()){n.push(o),i.push(t);continue}u(o)!==e[t]&&i.push(t)}else i.push(t)}return[n,i]}(n);for(const e of i)(0,E.lstatSync)(e).isFile()?(0,E.unlinkSync)(e):(0,E.rmSync)(e,{recursive:!0});0===t.length&&(R.saveWhenReload=!1,w(),Y());const o=[];for(const e of t){const n=(0,a.join)(c.root,e),i=`${c.updateFiles}/${e.replaceAll("\\","/")}`;(0,E.existsSync)((0,a.dirname)(n))||p(n),o.push({url:i,path:n})}g({array:o,downloadPage:e,isRoot:!0},(()=>{t=t.slice(1),0===t.length&&(R.saveWhenReload=!1,w(),Y())}))}))}()},unpackFiles:e=>{B(e)},enableDevTools:()=>{R.devTools=!0},disableDevTools:()=>{R.devTools=!1}}),O.loading=P(!0),O.loading.once("show",(()=>{O.loading.setText(V("[LOADING]")),function(){try{return(0,E.writeFileSync)(c.config,JSON.stringify(h,null,"\t")),!0}catch{const e=m.RU.ADMIN_REQUIRED_MESSAGE,n=m.EN.ADMIN_REQUIRED_MESSAGE,i=m.DE.ADMIN_REQUIRED_MESSAGE;return O.loading.setPersent(0),s.dialog.showMessageBoxSync({message:`RU: ${e}\n\nEN: ${n}\n\nDE: ${i}`,type:"warning",buttons:["Exit"],title:"Error"}),s.app.quit(),!1}}()&&(h.paths.initial?new Promise((e=>{(0,E.existsSync)((0,a.join)(c.mainTemp,"[media]"))&&u(h.paths.initial)===h.sums.initial?e():(N(),(0,E.existsSync)(c.backupInitial)?B(!0).then(e):F().then(e))})).then((()=>{!function(){let e=!0;return(0,E.existsSync)(h.paths.initial)?(0,E.existsSync)(c.classes)?h.settings.DLC&&!(0,E.existsSync)(c.dlc)&&(s.dialog.showMessageBoxSync({type:"warning",title:V("[ERROR]"),message:V("[DLC_FOLDER_NOT_FOUND]")}),h.settings.DLC=!1):(s.dialog.showMessageBoxSync({type:"warning",title:V("[ERROR]"),message:V("[CLASSES_NOT_FOUND]")}),e=!1):(s.dialog.showMessageBoxSync({type:"warning",title:V("[ERROR]"),message:V("[INITIAL_NOT_FOUND]")}),e=!1),e}()?W():new Promise((e=>{let n={};if((0,E.existsSync)(c.strings)){let e;switch(h.lang){case"RU":e="strings_russian.str";break;case"EN":e="strings_english.str";break;case"DE":e="strings_german.str"}let i=(0,a.join)(c.strings,e);(0,E.existsSync)(i)&&(n=d((0,E.readFileSync)(i,{encoding:"utf16le"}).toString()))}m.ingame=n,e()})).then((()=>{h.paths.dlc=c.dlc,h.paths.classes=c.classes,h.paths.mods=c.modsTemp,h.settings.DLC&&(h.dlcList=T(c.dlc,!0)),new Promise(((e,n)=>{if(!h.settings.mods)return void n();if(0===h.modsList.length)return void e();let i=h.modsList.length;function t(e){e=e.replace(".pak",""),delete h.modsList[e],delete h.sums.mods[e],h.modsList.length--,i--}for(const n in h.modsList){const o=h.modsList[n];if("number"==typeof o)continue;if(!(0,E.existsSync)(o.path)){A={name:h.modsList[n].name,error:"NOT_EXISTS"},t(h.modsList[n].name);continue}if(!y(o.path)){A={name:h.modsList[n].name,error:"NO_PERMISSION"},t(h.modsList[n].name);continue}const r=u(o.path);(0,E.existsSync)((0,a.join)(c.modsTemp,n))&&r===h.sums.mods[n]?i--:k(o.path).then((()=>{(0,E.existsSync)((0,a.join)(c.modsTemp,n,"classes"))?(h.sums.mods[n]=r,i--):(A={name:h.modsList[n].name,error:"NO_CLASSES"},t(h.modsList[n].name)),0===i&&e()}))}i<=0&&e()})).then((()=>{new Promise((e=>{const n={};for(const e in h.modsList)if((0,E.existsSync)((0,a.join)(c.modsTemp,e,"texts"))){let i;switch(h.lang){case"RU":i="strings_russian.str";break;case"EN":i="strings_english.str";break;case"DE":i="strings_german.str"}const t=(0,a.join)(c.modsTemp,e,"texts",i);if((0,E.existsSync)(t)){const i=d((0,E.readFileSync)(t,{encoding:"utf16le"}).toString());n[e]=i}}m.mods=n,e()})).then((()=>{C().then((()=>M()))}))}),(()=>{C().then((()=>M()))}))}))})):(D(),function(){const e=x({path:`file://${require("path").resolve(__dirname,"..","renderer","first_steps","index.html")}`,preload:require("path").resolve(__dirname,"../renderer","first_steps","preload.js"),width:550,height:500});e.once("show",(()=>{O.loading.isDestroyed()||O.loading.close()})),e.once("close",(()=>{s.app.quit()}))}(),M()))}))})),s.app.on("before-quit",(()=>{R.saveWhenReload&&v()})),process.once("uncaughtExceptionMonitor",s.app.quit)})(),module.exports=t})();