(()=>{"use strict";const e=require("fs"),n=require("path"),r=require("electron");window.ipc={sendSync:(e,...n)=>r.ipcRenderer.sendSync(e,...n),send:(e,...n)=>r.ipcRenderer.send(e,...n),on:(e,n)=>r.ipcRenderer.on(e,n),removeAll:e=>r.ipcRenderer.removeAllListeners(e)},window.service={readFileSync:n=>(0,e.readFileSync)(n).toString(),isDirectory:n=>(0,e.lstatSync)(n).isDirectory(),writeFileSync:e.writeFileSync,readdirSync:e.readdirSync,existsSync:e.existsSync,basename:n.basename,join:n.join};const{sendSync:i}=window.ipc,t=i("getInfo");function o(e,n){window.ipcErrorHandler?window.ipcErrorHandler(e.message,n):console.error(`Error on ${n}.\n${e}`.replace("Error: ",""))}const a=new Proxy({},{get(e,n){if(t.properties.includes(n)){const e=`property_${n}_get`,r=i(e);return r.error?(o(r.error,e),null):r.value}if(t.functions.includes(n))return(...e)=>{const r=`function_${n}_call`,t=i(r,...e);return t.error?(o(t.error,r),null):t.value}},set(e,n,r){if(t.properties.includes(n)){const e=`property_${n}_set`,t=i(e,r);return!t.error||(o(t.error,e),!1)}return!1}}),{sendSync:l}=window.ipc,s=new Proxy({},{get(e,n){const r=l("property_config_get").value[n];return Array.isArray(r)||"object"!=typeof r||null===r?r:new Proxy(r,{get:(e,n)=>r[n],set:(e,i,t)=>(r[i]=t,s[n]=r,!0)})},set:(e,n,r)=>(e[n]=r,!l("property_config_set",{key:n,value:r}).error)}),E={RU:{NEXT:"Дальше",GAME_FOLDER_LABEL:"Папка с игрой",GAME_DATA_STEP:"Игровые данные",FIRST_STEPS_DESCRIPTION:"Первоначальная настройка",IMPORT_CONFIG_MESSAGE:"Обнаружены настройки программы с предыдущей версии. Хотите использовать их?",EMPTY_FOLDER_ERROR:"Вы не выбрали папку!",INVALID_FOLDER_ERROR:"Вы выбрали неправильную папку. Попробуйте вручную выбрать initial.pak",INVALID_INITIAL_ERROR:"Выбран неверный initial.pak"},EN:{NEXT:"Next",GAME_FOLDER_LABEL:"Game folder",GAME_DATA_STEP:"Game data",FIRST_STEPS_DESCRIPTION:"Initial setup of the program",IMPORT_CONFIG_MESSAGE:"The program settings from the previous version have been detected. Do you want to use them?",EMPTY_FOLDER_ERROR:'You didn"t select a folder!',INVALID_FOLDER_ERROR:"You have selected the wrong folder!",INVALID_INITIAL_ERROR:"Invalid initial.pak selected"},DE:{NEXT:"Nächsten",GAME_FOLDER_LABEL:"Spiel-Ordner",GAME_DATA_STEP:"Spieldaten",FIRST_STEPS_DESCRIPTION:"Ersteinrichtung des Programms",IMPORT_CONFIG_MESSAGE:"Programmeinstellungen aus einer früheren Version wurden gefunden. Willst du sie benutzen?",EMPTY_FOLDER_ERROR:"Sie haben keinen Ordner ausgewählt!",INVALID_FOLDER_ERROR:"Sie haben den falschen Ordner ausgewählt!",INVALID_INITIAL_ERROR:"Ungültiger initial ausgewählt.pak"},CH:{NEXT:"下一个",GAME_FOLDER_LABEL:"游戏文件夹",GAME_DATA_STEP:"游戏数据",FIRST_STEPS_DESCRIPTION:"初始设置",IMPORT_CONFIG_MESSAGE:"找到了以前版本的程序设置。你愿意使用它们吗？",EMPTY_FOLDER_ERROR:"你没有选择一个文件夹!",INVALID_FOLDER_ERROR:"你选择了错误的文件夹。尝试手动选择initial.pak",INVALID_INITIAL_ERROR:"选择了错误的initial.pak"}}[s.lang],{getDir:R,getInitial:_}=a,{EMPTY_FOLDER_ERROR:c,INVALID_FOLDER_ERROR:d,INVALID_INITIAL_ERROR:I}=E;window.preload={getGameFolder:function(){const r=R();let i="";if(!r)return void window.handleErrorMessage(c);const t=r,o=[(0,n.join)(t,"steamapps/common/SnowRunner/preload/paks/client/initial.pak"),(0,n.join)(t,"common/SnowRunner/preload/paks/client/initial.pak"),(0,n.join)(t,"SnowRunner/en_us/preload/paks/client/initial.pak"),(0,n.join)(t,"en_us/preload/paks/client/initial.pak"),(0,n.join)(t,"preload/paks/client/initial.pak"),(0,n.join)(t,"paks/client/initial.pak"),(0,n.join)(t,"client/initial.pak"),(0,n.join)(t,"initial.pak")];for(let n=0;n<o.length;++n)if((0,e.existsSync)(o[n])){i=o[n];break}if(i)return{folder:t,initial:i};window.handleErrorMessage(d)},getInitialPak:function(){const r=_();if(r&&"initial.pak"===(0,n.basename)(r)&&(0,e.existsSync)(r))return{initial:r};window.handleErrorMessage(I)}}})();