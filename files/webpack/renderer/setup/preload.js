(()=>{"use strict";const e=require("fs"),n=require("path"),t=require("electron");window.provider=new class{constructor(){this.config=new Proxy({},{get:(e,n)=>{const i=t.ipcRenderer.sendSync("property_config_get").value[n];return Array.isArray(i)||"object"!=typeof i?i:new Proxy(i,{get:(e,n)=>i[n],set:(e,t,r)=>(i[t]=r,this.config[n]=i,!0)})},set:(e,n,i)=>(e[n]=i,!t.ipcRenderer.sendSync("property_config_set",{key:n,value:i}).error)}),this.local={pop(e){const n=localStorage.getItem(e);return localStorage.removeItem(e),"null"===n?null:"undefined"!==n?n:void 0},get(e){const n=localStorage.getItem(String(e));return"null"===n?null:"undefined"!==n?n:void 0},set(e,n){localStorage.setItem(String(e),n)}},this.ipcRenderer=t.ipcRenderer,this.paths=t.ipcRenderer.sendSync("property_paths_get").value,this.texts=t.ipcRenderer.sendSync("property_texts_get").value,window.onload=()=>{document.title=document.title.replace("{--VERSION--}",`v${this.config.version}`),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&"KeyS"===e.code){const e=document.querySelector("#save-params");e&&e.click()}else if("Escape"===e.code){const e=t.ipcRenderer.sendSync("get-windows-state");e.categories?t.app.quit():e.list?t.ipcRenderer.sendSync("function_openCategories_call"):e.editor?t.ipcRenderer.sendSync("function_openList_call"):window.close()}else e.ctrlKey&&"KeyQ"===e.code&&t.ipcRenderer.sendSync("function_quit_call")}))}}};const{config:i,texts:r}=window.provider,o=r[i.lang];var s,c,a,l,p,d,u,f,g,y,S,m;Object.defineProperty({},"MAIN",{get:()=>("#main",document.querySelector("#main"))}),function(e){e.engines="engines",e.gearboxes="gearboxes",e.suspensions="suspensions",e.wheels="wheels",e.winches="winches"}(s||(s={})),function(e){e.multiply="multiply",e.single="single"}(c||(c={})),function(e){e.text="text",e.number="number",e.coordinates="coordinates",e.file="file"}(a||(a={})),function(e){e.integer="int",e.float="float"}(l||(l={})),function(e){e.static="static",e.computed="computed",e.tagName="tagName"}(p||(p={})),function(e){e.input="input",e.group="group"}(d||(d={})),function(e){e[e.openSettings=1]="openSettings",e[e.openWhatsNew=2]="openWhatsNew",e[e.resetConfig=3]="resetConfig",e[e.devTools=4]="devTools",e[e.reload=5]="reload",e[e.quitApp=6]="quitApp",e[e.showFolder=7]="showFolder",e[e.separator=8]="separator",e[e.saveBackup=9]="saveBackup",e[e.recoverFromBackup=10]="recoverFromBackup",e[e.joinEPF=11]="joinEPF",e[e.seeEPF=12]="seeEPF",e[e.openURL=13]="openURL",e[e.uninstall=14]="uninstall",e[e.importConfig=15]="importConfig",e[e.exportConfig=16]="exportConfig"}(u||(u={})),function(e){e[e.open=0]="open",e[e.save=1]="save"}(f||(f={})),function(e){e[e.file=0]="file",e[e.dir=1]="dir"}(g||(g={})),function(e){e[e.sync=0]="sync",e[e.async=1]="async"}(y||(y={})),function(e){e.dev="dev",e.prod="prod"}(S||(S={})),function(e){e.RU="RU",e.EN="EN",e.DE="DE"}(m||(m={}));const{ipcRenderer:w}=window.provider,R=w.sendSync("getInfo"),_=e=>{w.sendSync("function_alertSync_call",`${e}`.replace("Error: ",""))},v=new Proxy({},{get:(e,n)=>{if(R.properties.includes(n)){const e=w.sendSync(`property_${n}_get`);return e.error?(_(e.error),null):e.value}if(R.functions.includes(n))return new Proxy((()=>{}),{apply:(e,t,i)=>{const r=w.sendSync(`function_${n}_call`,...i);return r.error?(_(r.error),null):r.value}})},set:(e,n,t)=>{if(R.properties.includes(n)){const e=w.sendSync(`property_${n}_set`,t);return!e.error||(_(e.error),!1)}return!1}}),{alertSync:h,openDialog:k,openInitialDialog:E}=v;window.setupPreload=new class{constructor(){this.errorHandler=e=>{h(o[e])},this.existsSync=e.existsSync,this.join=n.join,this.readFileSync=e.readFileSync,this.getGameFolder=()=>{const t=k();if(!t)return void this.errorHandler("EMPTY_FOLDER_ERROR");const i=t,r=[(0,n.join)(i,"steamapps","common","SnowRunner","preload","paks","client","initial.pak"),(0,n.join)(i,"common","SnowRunner","preload","paks","client","initial.pak"),(0,n.join)(i,"SnowRunner","en_us","preload","paks","client","initial.pak"),(0,n.join)(i,"en_us","preload","paks","client","initial.pak"),(0,n.join)(i,"preload","paks","client","initial.pak"),(0,n.join)(i,"paks","client","initial.pak"),(0,n.join)(i,"client","initial.pak"),(0,n.join)(i,"initial.pak")];let o="";for(const n of r)if((0,e.existsSync)(n)){o=n;break}if(o)return{folder:i,initial:o};this.errorHandler("INVALID_FOLDER_ERROR")},this.getInitial=()=>{const t=E();if(t&&"initial.pak"===(0,n.basename)(t)&&(0,e.existsSync)(t))return{initial:t};this.errorHandler("INVALID_INITIAL_ERROR")}}}})();