(()=>{"use strict";"undefined"!=typeof __webpack_require__&&(__webpack_require__.ab=__dirname+"/native_modules/");const e=require("fs"),n=require("path"),r=require("electron");var i,t,o;function s(e,n){console.error(`Error on ${n}.\n${e}`.replace("Error: ",""))}!function(e){e.get="get",e.set="set"}(i||(i={})),function(e){e.renderer="renderer",e.preload="preload"}(t||(t={})),function(e){e.getPublicInfo="GET_PUBLIC_INFO",e.functionCall="FUNCTION_CALL_",e.mainEventOn="MAIN_EVENT_ON_",e.mainEventOnce="MAIN_EVENT_ONCE_",e.mainEventEmit="MAIN_EVENT_EMIT_",e.propertyGet="PROPERTY_GET_",e.propertySet="PROPERTY_SET_",e.promisePostfix="_PROMISE",e.rendererEventEmit="RENDERER_EMIT_"}(o||(o={}));const a=function(e){const{info:n,scope:r,getVariable:t,setVariable:o,callFunction:a,handleMainEvent:c,waitPromise:d,emitRendererEvent:l}=e,E={as:()=>E};function p(e,i){let t;t=n.scopes.get(e).has(r)?i?.value?{get:()=>i.value,set:()=>{throw new Error(`'${e}' is readonly`)},enumerable:!0}:{get:i?.get||(()=>{throw new Error(`No access to getting '${e}'`)}),set:i?.set||(()=>{throw new Error(`'${e}' is readonly`)}),enumerable:!0}:{get(){throw new Error(`'${e}' is not provided into ${r} scope`)},set(){throw new Error(`'${e}' is not provided into ${r} scope`)}},Object.defineProperty(E,e,t)}return n.functions.forEach((e=>{p(e,{value(...n){const r=a(e,...n);if(!r.error)return r.promiseChannel?d(r.promiseChannel):r.value;s(r.error,e)}})})),n.rendererEvents.forEach((e=>{p(e,{value(n){l(e,n)}})})),n.mainEvents.forEach((e=>{const n=`on${e[0].toUpperCase()}${e.slice(1)}`,r=`once${e[0].toUpperCase()}${e.slice(1)}`;p(n,{value:n=>c(e,"on",(r=>{r.error?s(r.error,e):(r.promiseChannel&&d(r.promiseChannel).then(n),n(r.value))}))}),p(r,{value:n=>c(e,"once",(r=>{r.error?s(r.error,e):(r.promiseChannel&&d(r.promiseChannel).then(n),n(r.value))}))})})),n.properties.forEach((e=>{p(e,{get:n.accesses.get(e).has(i.get)?()=>{const n=t(e);if(!n.error)return n.value;s(n.error,e)}:()=>{throw new Error(`No access to getting the '${e}' property`)},set:n.accesses.get(e).has(i.set)?n=>{const r=o(e,n);r?.error&&s(r.error,e)}:()=>{throw new Error(`No access to setting the '${e}' property`)}})})),E},c=r.ipcRenderer.sendSync(o.getPublicInfo);if(!c)throw new Error("Public methods from main is not provided");const d=a({info:c,scope:t.preload,callFunction:(e,...n)=>r.ipcRenderer.sendSync(o.functionCall+e,...n),handleMainEvent(e,n,i){const t=(e,n)=>i(n),s=o.mainEventEmit+e;return"on"===n?(r.ipcRenderer.send(o.mainEventOn+e),r.ipcRenderer.on(s,t)):(r.ipcRenderer.send(o.mainEventOnce+e),r.ipcRenderer.once(s,t)),()=>r.ipcRenderer.removeListener(s,t)},emitRendererEvent(e,n){const i=o.rendererEventEmit+e;if(n instanceof Promise){const e=i+o.promisePostfix;r.ipcRenderer.sendSync(i,{promiseChannel:e}),n.then((n=>r.ipcRenderer.send(e,{value:n}))).catch((n=>r.ipcRenderer.send(e,{error:String(n)})))}else r.ipcRenderer.send(i,{value:n})},getVariable:e=>r.ipcRenderer.sendSync(o.propertyGet+e),setVariable:(e,n)=>r.ipcRenderer.sendSync(o.propertySet+e,n),waitPromise:e=>new Promise(((n,i)=>{r.ipcRenderer.once(e,((e,r)=>{r.error?i(r.error):n(r.value)}))}))}),l=r.ipcRenderer.sendSync(o.getPublicInfo),E=new class{constructor(){this.init()}register(e){window.ipc=e,this.init()}init(){const e=window.ipc;for(const n in e)this[n]=e[n]}};var p,u,R,g,_,f,h,m,w;!function(e){e.dev="dev",e.prod="prod"}(p||(p={})),function(e){e.trucks="trucks",e.trailers="trailers"}(u||(u={})),function(e){e.sync="sync",e.async="async"}(R||(R={})),function(e){e.file="file",e.dir="dir"}(g||(g={})),function(e){e.open="open",e.save="save"}(_||(_={})),function(e){e.engines="engines",e.gearboxes="gearboxes",e.suspensions="suspensions",e.wheels="wheels",e.winches="winches",e.truck="truck"}(f||(f={})),function(e){e.main="main",e.dlc="dlc",e.mods="mods",e.favorites="favorites"}(h||(h={})),function(e){e.text="text",e.number="number",e.select="select",e.coordinates="coordinates",e.file="file"}(m||(m={})),function(e){e.changeConfig="change-config",e.windowReady="window-ready-",e.windowResize="window-resize",e.handleWindowSize="handle-window-size"}(w||(w={}));const S=w;var O,v,I,T,A;!function(e){e.RU="RU",e.EN="EN",e.DE="DE",e.CH="CH"}(O||(O={})),function(e){e.integer="int",e.float="float"}(v||(v={})),function(e){e.editor="editor",e.lists="lists"}(I||(I={})),function(e){e.input="input",e.group="group"}(T||(T={})),function(e){e.common="common",e.lists="lists",e.editor="editor"}(A||(A={}));const L=A;var N,P,C;!function(e){e.Main="MainWindow",e.Settings="SettingsWindow",e.Update="UpdateWindow",e.WhatsNew="WhatsNewWindow",e.Loading="LoadingWindow",e.Setup="SetupWindow"}(N||(N={})),function(e){e.mods="mods",e.dlc="dlc",e.main="main",e.favorites="favorites"}(P||(P={})),function(e){e.multiply="multiply",e.single="single"}(C||(C={}));const y=new class{register(e,n=L.common){window.preloads||(window.preloads={}),window.preloads[n]&&console.warn(`Overwriting preload (type='${n}')`),window.preloads[n]=e}get(e=L.common){if(!window.preloads)throw new Error("Preloads not defined");const n=window.preloads[e];if(!n)throw new Error(`Preload not found (type='${e}')`);return n}};new class{pop(e){const n=this.get(e);return localStorage.removeItem(e),n}get(e){const n=localStorage.getItem(e);switch(n){case"null":return null;case"undefined":return;default:return n}}set(e,n){localStorage.setItem(e,n)}};const M=new class{constructor(){this.init()}register(e){window.service=e,this.init()}init(){const e=window.service;for(const n in e)this[n]=e[n]}};!function(e=!0){const n={getInfo:()=>l,waitPromise(e,n,i){r.ipcRenderer.once(e,((e,r)=>{r.error?i?.(r.error):n(r.value)}))},provided:{properties:{},functions:{},mainEvents:{},rendererEvents:{}}};l.functions.forEach((e=>{n.provided.functions[e]=(...n)=>r.ipcRenderer.sendSync(o.functionCall+e,...n)})),l.rendererEvents.forEach((e=>{n.provided.rendererEvents[e]=n=>{const i=o.rendererEventEmit+e;n instanceof Promise?n.then((e=>r.ipcRenderer.send(i,{value:e}))).catch((e=>r.ipcRenderer.send(i,{error:String(e)}))):r.ipcRenderer.send(i,{value:n})}})),l.mainEvents.forEach((e=>{n.provided.mainEvents[e]=(n,i)=>{const t=(e,n)=>i(n),s=o.mainEventEmit+e;return"on"===n?(r.ipcRenderer.on(s,t),r.ipcRenderer.send(o.mainEventOn+e)):(r.ipcRenderer.once(s,t),r.ipcRenderer.send(o.mainEventOnce+e)),()=>r.ipcRenderer.removeListener(s,t)}})),l.properties.forEach((e=>{n.provided.properties[e]={get:()=>r.ipcRenderer.sendSync(o.propertyGet+e),set(n){r.ipcRenderer.sendSync(o.propertySet+e,n)}}})),e?r.contextBridge.exposeInMainWorld("__provider__",n):window.__provider__=n}(!1),new class{constructor(){this.addIPC(),this.addSystem()}addIPC(){E.register({sendSync:(e,...n)=>r.ipcRenderer.sendSync(e,...n),send(e,...n){r.ipcRenderer.send(e,...n)},on(e,n){r.ipcRenderer.on(e,n)},once(e,n){r.ipcRenderer.once(e,n)},remove(e,n){r.ipcRenderer.removeListener(e,n)},removeAll(e){r.ipcRenderer.removeAllListeners(e)}})}addSystem(){M.register({readFileSync:n=>(0,e.readFileSync)(n).toString(),isDirectory:n=>(0,e.lstatSync)(n).isDirectory(),writeFileSync:e.writeFileSync,readdirSync:e.readdirSync,existsSync:e.existsSync,basename:n.basename,join:n.join})}};const D={RU:{SUCCESS_EXPORT_MESSAGE:"Конфигурация успешно экпортирована",LOADING:"Загрузка",OPEN_BUTTON:"Открыть",SAVE_BUTTON:"Сохранить",RESET_MENU_ITEM_LABEL:"Сбросить",EXPORT:"Экспорт",ERROR:"Ошибка",LANGUAGE_LABEL:"Язык программы",OK:"Ок",CANCEL:"Отменить"},EN:{SUCCESS_EXPORT_MESSAGE:"Configuration exported successfully",LOADING:"Loading",OPEN_BUTTON:"Open",SAVE_BUTTON:"Save",RESET_MENU_ITEM_LABEL:"Reset",EXPORT:"Export",ERROR:"Error",LANGUAGE_LABEL:"Program language",OK:"Ok",CANCEL:"Cancel"},DE:{SUCCESS_EXPORT_MESSAGE:"Konfiguration erfolgreich exportiert",LOADING:"Herunterladen",OPEN_BUTTON:"Öffnen",SAVE_BUTTON:"Datei",RESET_MENU_ITEM_LABEL:"Zurücksetzen",EXPORT:"Export",ERROR:"Fehler",LANGUAGE_LABEL:"Programmsprache",OK:"Ok",CANCEL:"Stornieren"},CH:{SUCCESS_EXPORT_MESSAGE:"配置已成功导出",LOADING:"加载",OPEN_BUTTON:"打开",SAVE_BUTTON:"保存",RESET_MENU_ITEM_LABEL:"重置",EXPORT:"导出",ERROR:"误差",LANGUAGE_LABEL:"方案语言",OK:"确认",CANCEL:"取消"}};function b(e){return"object"==typeof e}function G(e){return null!=e}if(!window.__provider__)throw new Error('Required methods not provided. Did you forget to call "provide" in preload?');const k=window.__provider__,F=a({info:k.getInfo(),scope:t.renderer,callFunction:(e,...n)=>k.provided.functions[e](...n),emitRendererEvent(e,n){k.provided.rendererEvents[e](n)},handleMainEvent:(e,n,r)=>k.provided.mainEvents[e](n,r),getVariable:e=>k.provided.properties[e].get(),setVariable(e,n){k.provided.properties[e].set(n)},waitPromise:e=>new Promise(((n,r)=>{k.waitPromise(e,n,r)}))}).as(),U=new class{constructor(){this.changeHandlers=new Set,this.config={...F.config},this.addChangeHandler=e=>{this.changeHandlers.add(e)},this.removeChangeHandler=e=>{this.changeHandlers.delete(e)},this.onChangeConfig=()=>{Object.assign(this.config,F.config),this.changeHandlers.forEach((e=>e()))},this.defineObject(this.config,this),E.on(S.changeConfig,this.onChangeConfig)}defineObject(e,n){for(const r in e){const i=e[r];if(b(i)&&!Array.isArray(i)&&G(i)){const t={};this.defineObject(i,t),Object.defineProperty(n,r,{get:()=>t,set:n=>this.changeConfig((()=>e[r]=n)),configurable:!0,enumerable:!0})}else this.define(e,n,r)}}define(e,n,r){Object.defineProperty(n,r,{get:()=>e[r],set:n=>this.changeConfig((()=>e[r]=n)),configurable:!0,enumerable:!0})}changeConfig(e){e(),F.config=this.config}};function V(e){let n=U.lang;function r(){U.lang!==n&&(n=U.lang,e())}return U.addChangeHandler(r),()=>U.removeChangeHandler(r)}function B(e){return new class{constructor(e,n,r){this.texts=e,this.getLang=n,this.get=()=>this.localized,this.onChangeLang=()=>{Object.assign(this.localized,this.texts[this.getLang()])},this.localized={...e[n()]},r&&r(this.onChangeLang)}}(e,(()=>U.lang),V).get()}B(D);const j=($=D,H=B,(e,n)=>{const r={...$};for(const n in e)Object.assign(r[n],e[n]);if(n)for(const e in r)Object.assign(r[e],n);return H(r)})({RU:{NEXT:"Дальше",GAME_FOLDER_LABEL:"Папка с игрой",GAME_DATA_STEP:"Игровые данные",FIRST_STEPS_DESCRIPTION:"Первоначальная настройка",IMPORT_CONFIG_MESSAGE:"Обнаружены настройки программы с предыдущей версии. Хотите использовать их?",EMPTY_FOLDER_ERROR:"Вы не выбрали папку!",INVALID_FOLDER_ERROR:"Вы выбрали неправильную папку. Попробуйте вручную выбрать initial.pak",INVALID_INITIAL_ERROR:"Выбран неверный initial.pak"},EN:{NEXT:"Next",GAME_FOLDER_LABEL:"Game folder",GAME_DATA_STEP:"Game data",FIRST_STEPS_DESCRIPTION:"Initial setup of the program",IMPORT_CONFIG_MESSAGE:"The program settings from the previous version have been detected. Do you want to use them?",EMPTY_FOLDER_ERROR:"You didn't select a folder!",INVALID_FOLDER_ERROR:"You have selected the wrong folder!",INVALID_INITIAL_ERROR:"Invalid initial.pak selected"},DE:{NEXT:"Nächsten",GAME_FOLDER_LABEL:"Spiel-Ordner",GAME_DATA_STEP:"Spieldaten",FIRST_STEPS_DESCRIPTION:"Ersteinrichtung des Programms",IMPORT_CONFIG_MESSAGE:"Programmeinstellungen aus einer früheren Version wurden gefunden. Willst du sie benutzen?",EMPTY_FOLDER_ERROR:"Sie haben keinen Ordner ausgewählt!",INVALID_FOLDER_ERROR:"Sie haben den falschen Ordner ausgewählt!",INVALID_INITIAL_ERROR:"Ungültiger initial ausgewählt.pak"},CH:{NEXT:"下一个",GAME_FOLDER_LABEL:"游戏文件夹",GAME_DATA_STEP:"游戏数据",FIRST_STEPS_DESCRIPTION:"初始设置",IMPORT_CONFIG_MESSAGE:"找到了以前版本的程序设置。你愿意使用它们吗？",EMPTY_FOLDER_ERROR:"你没有选择一个文件夹!",INVALID_FOLDER_ERROR:"你选择了错误的文件夹。尝试手动选择initial.pak",INVALID_INITIAL_ERROR:"选择了错误的initial.pak"}}),x=d.as();var $,H;new class{constructor(){this.getGameFolder=()=>{const r=x.getDir();let i="";if(!r)return void window.handleErrorMessage?.(j.EMPTY_FOLDER_ERROR);const t=r,o=[(0,n.join)(t,"steamapps/common/SnowRunner/preload/paks/client/initial.pak"),(0,n.join)(t,"common/SnowRunner/preload/paks/client/initial.pak"),(0,n.join)(t,"SnowRunner/en_us/preload/paks/client/initial.pak"),(0,n.join)(t,"en_us/preload/paks/client/initial.pak"),(0,n.join)(t,"preload/paks/client/initial.pak"),(0,n.join)(t,"paks/client/initial.pak"),(0,n.join)(t,"client/initial.pak"),(0,n.join)(t,"initial.pak")];for(let n=0;n<o.length;++n)if((0,e.existsSync)(o[n])){i=o[n];break}if(i)return{folder:t,initial:i};window.handleErrorMessage?.(j.INVALID_FOLDER_ERROR)},this.getInitialPak=()=>{const r=x.getInitial();if(r&&"initial.pak"===(0,n.basename)(r)&&(0,e.existsSync)(r))return{initial:r};window.handleErrorMessage?.(j.INVALID_INITIAL_ERROR)},y.register({getGameFolder:this.getGameFolder,getInitialPak:this.getInitialPak})}}})();