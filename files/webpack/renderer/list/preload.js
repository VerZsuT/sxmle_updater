(()=>{"use strict";const e=require("path"),n=require("fs"),r=require("electron");window.config=new Proxy({},{get:(e,n)=>{const t=r.ipcRenderer.sendSync("property_config_get").value[n];return Array.isArray(t)||"object"!=typeof t?t:new Proxy(t,{get:(e,n)=>t[n],set:(e,r,o)=>(t[r]=o,window.config[n]=t,!0)})},set:(e,n,t)=>(e[n]=t,!r.ipcRenderer.sendSync("property_config_set",{key:n,value:t}).error)}),window.local={pop(e){const n=localStorage.getItem(e);return localStorage.removeItem(e),"null"===n?null:"undefined"!==n?n:void 0},get(e){const n=localStorage.getItem(String(e));return"null"===n?null:"undefined"!==n?n:void 0},set(e,n){localStorage.setItem(String(e),n)}},window.ipcRenderer=r.ipcRenderer,window.paths=r.ipcRenderer.sendSync("property_paths_get").value,window.texts=r.ipcRenderer.sendSync("property_texts_get").value,window.onload=()=>{document.title=document.title.replace("{--VERSION--}",`v${config.version}`),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&"KeyS"===e.code){const e=document.querySelector("#save-params");e&&e.click()}else"Escape"===e.code?window.close():e.ctrlKey&&"KeyQ"===e.code&&r.ipcRenderer.sendSync("function_quit_call")}))};const t=(...n)=>(0,e.resolve)(__dirname,...n);function o(r,t,s=".xml",i){if(!(0,n.existsSync)(r))return[];let c=[];const a=(0,n.readdirSync)(r);for(let l=0;l<a.length;l++){const u=(0,e.join)(r,a[l]),d=(0,n.lstatSync)(u);if(t){if(!d.isDirectory())continue;c.push({name:a[l],path:u})}d.isDirectory()&&i?c=[...c,...o(u,!1,s,!0)]:a[l].indexOf(s)>=0&&c.push({name:a[l].replace(s,""),path:u})}return c}t("..",".."),t("config.json"),t("backups"),t("favicon.ico"),t("backups","initial.pak"),t("translations"),t("winrar"),t("mainTemp"),t("modsTemp"),t("mainTemp","[strings]"),t("mainTemp","[media]","_dlc"),t("mainTemp","[media]","classes"),texts[config.lang];var s,i,c,a,l,u,d,p;Object.defineProperty({},"MAIN",{get:()=>("#main",document.querySelector("#main"))}),function(e){e.engines="engines",e.gearboxes="gearboxes",e.suspensions="suspensions",e.wheels="wheels",e.winches="winches"}(s||(s={})),function(e){e.multiply="multiply",e.single="single"}(i||(i={})),function(e){e.text="text",e.number="number",e.coordinates="coordinates",e.file="file"}(c||(c={})),function(e){e.integer="int",e.float="float"}(a||(a={})),function(e){e.static="static",e.computed="computed",e.tagName="tagName"}(l||(l={})),function(e){e.openSettings="openSettings",e.resetConfig="resetConfig",e.devTools="devTools",e.reload="reload",e.quitApp="quitApp",e.showFolder="showFolder",e.separator="separator",e.saveBackup="saveBackup",e.recoverFromBackup="recoverFromBackup",e.joinEPF="joinEPF",e.seeEPF="seeEPF",e.openURL="openURL"}(u||(u={})),function(e){e.dev="dev",e.prod="prod"}(d||(d={})),function(e){e.RU="RU",e.EN="EN",e.DE="DE"}(p||(p={}));const m=ipcRenderer.sendSync("getInfo"),g=e=>{ipcRenderer.sendSync("function_alertSync_call",`${e}`.replace("Error: ",""))},f=new Proxy({},{get(e,n){if(m.properties.includes(n)){const e=ipcRenderer.sendSync(`property_${n}_get`);return e.error?(g(e.error),null):e.value}if(m.functions.includes(n))return new Proxy((()=>{}),{apply(e,r,t){const o=ipcRenderer.sendSync(`function_${n}_call`,...t);return o.error?(g(o.error),null):o.value}})},set(e,n,r){if(m.properties.includes(n)){const e=ipcRenderer.sendSync(`property_${n}_set`,r);return!e.error||(g(e.error),!1)}return!1}}),y={exists:r=>(0,n.existsSync)((0,e.join)(__dirname,r)),removeDir:e=>{(0,n.rmSync)(e,{recursive:!0})},getModPak(){const n=f.openInitialDialog();return{id:(0,e.basename)(n,".pak"),path:n,name:(0,e.basename)(n)}},join:(...n)=>(0,e.join)(...n),getList:(n,r)=>{if("dlc"===r){const r=[];for(const t of config.dlcList){const s=`${t.path}\\classes`;let i=[];"trucks"===n?i=o((0,e.join)(s,"trucks")):"trailers"===n?i=o((0,e.join)(s,"trucks","trailers")):"cargo"===n&&(i=o((0,e.join)(s,"trucks","cargo"))),r.push({dlcName:t.name,items:i})}return r}if("mods"===r){const r=[];for(const t in config.modsList){let s=[];if("length"===t)continue;const i=config.modsList[t];"trucks"===n||"trailers"===n?s=o((0,e.join)(paths.modsTemp,t,"classes","trucks"),!1,".xml",!0):"cargo"===n&&(s=o((0,e.join)(paths.modsTemp,t,"classes","trucks","cargo"))),r.push({id:t,name:i.name,items:s})}return r}return"trucks"===n?o((0,e.join)(paths.classes,"trucks")):"trailers"===n?o((0,e.join)(paths.classes,"trucks","trailers")):"cargo"===n?o((0,e.join)(paths.classes,"trucks","cargo")):void 0}};window.listPreload=y})();