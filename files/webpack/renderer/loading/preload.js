(()=>{"use strict";const e=require("fs"),n=require("path"),r=require("electron");window.config=new Proxy({},{get:(e,n)=>{const o=r.ipcRenderer.sendSync("property_config_get").value[n];return Array.isArray(o)||"object"!=typeof o?o:new Proxy(o,{get:(e,n)=>o[n],set:(e,r,t)=>(o[r]=t,window.config[n]=o,!0)})},set:(e,n,o)=>(e[n]=o,!r.ipcRenderer.sendSync("property_config_set",{key:n,value:o}).error)}),window.local={pop(e){const n=localStorage.getItem(e);return localStorage.removeItem(e),"null"===n?null:"undefined"!==n?n:void 0},get(e){const n=localStorage.getItem(String(e));return"null"===n?null:"undefined"!==n?n:void 0},set(e,n){localStorage.setItem(String(e),n)}},window.ipcRenderer=r.ipcRenderer,window.paths=r.ipcRenderer.sendSync("property_paths_get").value,window.texts=r.ipcRenderer.sendSync("property_texts_get").value,window.onload=()=>{document.title=document.title.replace("{--VERSION--}",`v${config.version}`),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&"KeyS"===e.code){const e=document.querySelector("#save-params");e&&e.click()}else"Escape"===e.code?window.close():e.ctrlKey&&"KeyQ"===e.code&&r.ipcRenderer.sendSync("function_quit_call")}))};const o=texts[config.lang];var t,i,c,s,a,l,p,d,u,f,y;Object.defineProperty({},"MAIN",{get:()=>("#main",document.querySelector("#main"))}),function(e){e.engines="engines",e.gearboxes="gearboxes",e.suspensions="suspensions",e.wheels="wheels",e.winches="winches"}(t||(t={})),function(e){e.multiply="multiply",e.single="single"}(i||(i={})),function(e){e.text="text",e.number="number",e.coordinates="coordinates",e.file="file"}(c||(c={})),function(e){e.integer="int",e.float="float"}(s||(s={})),function(e){e.static="static",e.computed="computed",e.tagName="tagName"}(a||(a={})),function(e){e.openSettings="openSettings",e.resetConfig="resetConfig",e.devTools="devTools",e.reload="reload",e.quitApp="quitApp",e.showFolder="showFolder",e.separator="separator",e.saveBackup="saveBackup",e.recoverFromBackup="recoverFromBackup",e.joinEPF="joinEPF",e.seeEPF="seeEPF",e.openURL="openURL"}(l||(l={})),function(e){e.open="open",e.save="save"}(p||(p={})),function(e){e.file="file",e.dir="dir"}(d||(d={})),function(e){e.sync="sync",e.async="async"}(u||(u={})),function(e){e.dev="dev",e.prod="prod"}(f||(f={})),function(e){e.RU="RU",e.EN="EN",e.DE="DE"}(y||(y={}));const g=ipcRenderer.sendSync("getInfo"),w=e=>{ipcRenderer.sendSync("function_alertSync_call",`${e}`.replace("Error: ",""))},R=new Proxy({},{get(e,n){if(g.properties.includes(n)){const e=ipcRenderer.sendSync(`property_${n}_get`);return e.error?(w(e.error),null):e.value}if(g.functions.includes(n))return new Proxy((()=>{}),{apply(e,r,o){const t=ipcRenderer.sendSync(`function_${n}_call`,...o);return t.error?(w(t.error),null):t.value}})},set(e,n,r){if(g.properties.includes(n)){const e=ipcRenderer.sendSync(`property_${n}_set`,r);return!e.error||(w(e.error),!1)}return!1}}),S={errorHandler:e=>{R.alertSync(o[e])},existsSync:e.existsSync,join:n.join,get gameFolder(){const r=R.openDialog();if(!r)return void S.errorHandler("EMPTY_FOLDER_ERROR");const o=r,t=[(0,n.join)(o,"steamapps","common","SnowRunner","en_us","preload","paks","client","initial.pak"),(0,n.join)(o,"common","SnowRunner","en_us","preload","paks","client","initial.pak"),(0,n.join)(o,"SnowRunner","en_us","preload","paks","client","initial.pak"),(0,n.join)(o,"en_us","preload","paks","client","initial.pak"),(0,n.join)(o,"preload","paks","client","initial.pak"),(0,n.join)(o,"paks","client","initial.pak"),(0,n.join)(o,"client","initial.pak"),(0,n.join)(o,"initial.pak")];let i="";for(const n of t)if((0,e.existsSync)(n)){i=n;break}if(i)return{folder:o,initial:i};S.errorHandler("INVALID_FOLDER_ERROR")},get initial(){const r=R.openInitialDialog();if(r&&"initial.pak"===(0,n.basename)(r)&&(0,e.existsSync)(r))return{initial:r};S.errorHandler("INVALID_INITIAL_ERROR")}};window.setupPreload=S})();